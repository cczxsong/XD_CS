## 学生课程成绩实验报告

------

### 实验题目

输入文件为学生成绩信息，包含了必修课与选修课成绩，格式如下：.（注：</br>为换行符）

班级1, 姓名1, 科目1, 成绩1 <br>班级2, 姓名2, 科目1, 成绩2 <br>班级1, 姓名1, 科目2, 成绩3 <br>………., ………, ………, ………   <br>编写Hadoop平台上的MapReduce程序，实现如下功能：

1. 计算每个学生必修课的平均成绩。
2. 按科目统计每个班的平均成绩。

### 设计思想

首先，题目要求实现两个功能。

主要就是对WordCount中的map模块和reduce模块的改写

Map阶段：

先对文件中读取的字符串按照“，”分隔开来，功能一是对读取到的字符串筛选，如果有“必修”字符，才是有效的条目，对其进行提取并输出为<Key,Value>对，其中，key为学生姓名，Value为学生的必修课程成绩。功能二则是对读取到的每一条字符串，提取其中的班级和科目作为Key，Value则是成绩。

Reduce阶段：

对Map阶段得到的每一个<Key,Value>对，进行整合，相同的Key进行加和求均值，再输出。

### 遇到的问题及解决方法

第一次求出来的课程平均值都是整数，各个条目数据偏差不大。

解决办法是将reduce阶段的输出结果设置成DoubleWritable,在进行除法运算的时候做运算，就会在输出时输出想要的结果。
$$
(sum*1.0)/count
$$

还有一个就是编码的问题，解决办法就是尽量不要使用汉字。

### 实验结果

![1559796907313](C:\Users\王\AppData\Local\Temp\1559796907313.png)

![1559796967614](C:\Users\王\AppData\Local\Temp\1559796967614.png)





### 心得体会

通过这次实验，我对hadoop框架MapReduce中的WordCount例子有了更深的了解，对hadoop框架MapReduce计算有了简单的编程经历，对Map和reduce之间的关系也有了更深的理解，